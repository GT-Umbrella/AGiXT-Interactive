"use strict";(self.webpackChunk_agixt_interactive=self.webpackChunk_agixt_interactive||[]).push([[486],{"./components/Chat/Message/Message.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{CSVCode:()=>CSVCode,GenericCode:()=>GenericCode,InlineCode:()=>InlineCode,JavascriptCode:()=>JavascriptCode,MarkdownCode:()=>MarkdownCode,PythonCode:()=>PythonCode,__namedExportsOrder:()=>__namedExportsOrder,default:()=>Message_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),useTheme=__webpack_require__("./node_modules/@mui/material/styles/useTheme.js"),Box=__webpack_require__("./node_modules/@mui/material/Box/Box.js"),Typography=__webpack_require__("./node_modules/@mui/material/Typography/Typography.js"),Tooltip=__webpack_require__("./node_modules/@mui/material/Tooltip/Tooltip.js"),IconButton=__webpack_require__("./node_modules/@mui/material/IconButton/IconButton.js"),Dialog=__webpack_require__("./node_modules/@mui/material/Dialog/Dialog.js"),DialogTitle=__webpack_require__("./node_modules/@mui/material/DialogTitle/DialogTitle.js"),DialogContent=__webpack_require__("./node_modules/@mui/material/DialogContent/DialogContent.js"),DialogContentText=__webpack_require__("./node_modules/@mui/material/DialogContentText/DialogContentText.js"),TextField=__webpack_require__("./node_modules/@mui/material/TextField/TextField.js"),DialogActions=__webpack_require__("./node_modules/@mui/material/DialogActions/DialogActions.js"),Button=__webpack_require__("./node_modules/@mui/material/Button/Button.js"),createSvgIcon=__webpack_require__("./node_modules/@mui/material/utils/createSvgIcon.js");const ThumbUp=(0,createSvgIcon.A)((0,jsx_runtime.jsx)("path",{d:"M1 21h4V9H1zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73z"}),"ThumbUp"),ThumbDown=(0,createSvgIcon.A)((0,jsx_runtime.jsx)("path",{d:"M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2m4 0v12h4V3z"}),"ThumbDown");var _InlineCode_parameters,_InlineCode_parameters_docs,_InlineCode_parameters1,_GenericCode_parameters,_GenericCode_parameters_docs,_GenericCode_parameters1,_MarkdownCode_parameters,_MarkdownCode_parameters_docs,_MarkdownCode_parameters1,_CSVCode_parameters,_CSVCode_parameters_docs,_CSVCode_parameters1,_PythonCode_parameters,_PythonCode_parameters_docs,_PythonCode_parameters1,_JavascriptCode_parameters,_JavascriptCode_parameters_docs,_JavascriptCode_parameters1,ContentCopy=__webpack_require__("./node_modules/@mui/icons-material/esm/ContentCopy.js"),Download=__webpack_require__("./node_modules/@mui/icons-material/esm/Download.js"),clipboard_copy=__webpack_require__("./node_modules/clipboard-copy/index.js"),clipboard_copy_default=__webpack_require__.n(clipboard_copy),InteractiveConfigContext=__webpack_require__("./types/InteractiveConfigContext.ts"),MarkdownBlock=__webpack_require__("./components/Chat/Message/MarkdownBlock.tsx"),formatDate=__webpack_require__("./components/Chat/Message/formatDate.ts"),console=__webpack_require__("./node_modules/console-browserify/index.js"),process=__webpack_require__("./node_modules/process/browser.js");function Message(param){let{chatItem,lastUserMessage,alternateBackground="primary",setLoading}=param;var _audios_sources,_audios_message,_audios_message1;const state=(0,react.useContext)(InteractiveConfigContext.k),formattedMessage=(0,react.useMemo)((()=>{let formatted=chatItem.message;try{formatted=(JSON.parse(chatItem.message).text||chatItem.message).replace("\\n","\n")}catch(e){formatted=chatItem.message.replace(/\\n/g,"  \n").replace(/\n/g,"  \n")}return formatted}),[chatItem]),audios=(0,react.useMemo)((()=>{if((null==chatItem?void 0:chatItem.message)&&"string"==typeof chatItem.message&&chatItem.message.includes("<audio controls><source src=")){const audioSources=[...chatItem.message.matchAll(/<audio controls><source src="(.*?)" type="audio\/wav"><\/audio>/g)].map((match=>match[1]));return{message:chatItem.message.replaceAll(/<audio controls><source src="(.*?)" type="audio\/wav"><\/audio>/g,""),sources:audioSources}}return null}),[chatItem]);console.log("Audios",audios);const[vote,setVote]=(0,react.useState)(chatItem.rlhf?chatItem.rlhf.positive?1:-1:0),[open,setOpen]=(0,react.useState)(!1),[feedback,setFeedback]=(0,react.useState)(""),theme=(0,useTheme.A)();return(0,jsx_runtime.jsxs)(Box.A,{sx:{backgroundColor:"USER"===chatItem.role?theme.palette.background.default:theme.palette[String(alternateBackground)][theme.palette.mode],padding:"10px",overflow:"hidden",position:"center",color:theme.palette.text.primary},children:[(null==audios||null===(_audios_sources=audios.sources)||void 0===_audios_sources?void 0:_audios_sources.length)>0?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(null==audios||null===(_audios_message=audios.message)||void 0===_audios_message?void 0:_audios_message.trim())&&(0,jsx_runtime.jsx)(MarkdownBlock.A,{content:formattedMessage,chatItem:{...chatItem,message:audios.message},setLoading}),audios.sources.map((src=>(0,jsx_runtime.jsxs)("audio",{controls:!0,children:[(0,jsx_runtime.jsx)("source",{src,type:"audio/wav"}),(0,jsx_runtime.jsx)("track",{kind:"captions"})]},src)))]}):(0,jsx_runtime.jsx)(MarkdownBlock.A,{content:formattedMessage,chatItem,setLoading}),""!==chatItem.timestamp&&(0,jsx_runtime.jsxs)(Typography.A,{variant:"caption",style:{width:"100%",display:"inline-block"},children:[(0,jsx_runtime.jsx)("b",{children:"USER"===chatItem.role?"You":chatItem.role})," â€¢"," ",(0,jsx_runtime.jsx)(Tooltip.A,{title:(0,formatDate.A)(chatItem.timestamp,!1),children:(0,jsx_runtime.jsx)("span",{children:void 0===chatItem.timestamp?"Just Now...":(0,formatDate.A)(chatItem.timestamp)})})]}),((null==audios||null===(_audios_message1=audios.message)||void 0===_audios_message1?void 0:_audios_message1.trim())||!audios)&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["USER"!==chatItem.role&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["true"===process.env.NEXT_PUBLIC_AGIXT_RLHF&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Tooltip.A,{title:"Provide Positive Feedback",children:(0,jsx_runtime.jsx)(IconButton.A,{onClick:()=>{setVote(1),setOpen(!0)},children:(0,jsx_runtime.jsx)(ThumbUp,{color:1===vote?"success":"inherit"})})}),(0,jsx_runtime.jsx)(Tooltip.A,{title:"Provide Negative Feedback",children:(0,jsx_runtime.jsx)(IconButton.A,{onClick:()=>{setVote(-1),setOpen(!0)},children:(0,jsx_runtime.jsx)(ThumbDown,{color:-1===vote?"error":"inherit"})})})]}),(0,jsx_runtime.jsx)(Tooltip.A,{title:"Copy Message",children:(0,jsx_runtime.jsx)(IconButton.A,{onClick:()=>{clipboard_copy_default()(formattedMessage)},children:(0,jsx_runtime.jsx)(ContentCopy.A,{})})}),(0,jsx_runtime.jsx)(Tooltip.A,{title:"Download Message",children:(0,jsx_runtime.jsx)(IconButton.A,{onClick:()=>{const element=document.createElement("a"),file=new Blob([formattedMessage],{type:"text/plain;charset=utf-8"});element.href=URL.createObjectURL(file),element.download="".concat(chatItem.role,"-").concat(chatItem.timestamp,".txt"),document.body.appendChild(element),element.click()},children:(0,jsx_runtime.jsx)(Download.A,{})})}),chatItem.rlhf&&(0,jsx_runtime.jsx)(Typography.A,{variant:"caption",color:chatItem.rlhf.positive?"success":"error",children:chatItem.rlhf.feedback})]}),(0,jsx_runtime.jsxs)(Dialog.A,{open,onClose:()=>{setOpen(!1)},"aria-labelledby":"form-dialog-title",children:[(0,jsx_runtime.jsx)(DialogTitle.A,{id:"form-dialog-title",children:"Provide Feedback"}),(0,jsx_runtime.jsxs)(DialogContent.A,{children:[(0,jsx_runtime.jsx)(DialogContentText.A,{children:"Please provide some feedback regarding the message."}),(0,jsx_runtime.jsx)(TextField.A,{margin:"dense",id:"name",label:"Feedback",type:"text",fullWidth:!0,value:feedback,onChange:e=>setFeedback(e.target.value)})]}),(0,jsx_runtime.jsxs)(DialogActions.A,{children:[(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{setOpen(!1)},color:"error",children:"Cancel"}),(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{setOpen(!1),1===vote?state.agixt.addConversationFeedback(!0,chatItem.role,chatItem.message,lastUserMessage,feedback,state.overrides.conversationName):state.agixt.addConversationFeedback(!1,chatItem.role,chatItem.message,lastUserMessage,feedback,state.overrides.conversationName)},color:"info",children:"Submit"})]})]})]})]})}Message.__docgenInfo={description:"",methods:[],displayName:"Message",props:{chatItem:{required:!0,tsType:{name:"signature",type:"object",raw:"{ role: string; message: string; timestamp: string; rlhf?: { positive: boolean; feedback: string } }",signature:{properties:[{key:"role",value:{name:"string",required:!0}},{key:"message",value:{name:"string",required:!0}},{key:"timestamp",value:{name:"string",required:!0}},{key:"rlhf",value:{name:"signature",type:"object",raw:"{ positive: boolean; feedback: string }",signature:{properties:[{key:"positive",value:{name:"boolean",required:!0}},{key:"feedback",value:{name:"string",required:!0}}]},required:!1}}]}},description:""},lastUserMessage:{required:!0,tsType:{name:"string"},description:""},alternateBackground:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'primary'",computed:!1}},setLoading:{required:!0,tsType:{name:"signature",type:"function",raw:"(loading: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"loading"}],return:{name:"void"}}},description:""}}};const Message_stories={title:"Messaging/Message",component:Message,tags:["autodocs"],parameters:{componentSubtitle:"A Sample Component",docs:{description:{component:"This component is meant to illustrate how to effectively document components."}},references:[]}},InlineCode=args=>(0,jsx_runtime.jsx)(Message,{...args});InlineCode.args={inline:!0,children:'console.log("Hello, World!");'};const GenericCode=args=>(0,jsx_runtime.jsx)(Message,{...args});GenericCode.args={children:'console.log("Hello, World!");\nconsole.log("Welcome to my code block!");'};const MarkdownCode=args=>(0,jsx_runtime.jsx)(Message,{...args});MarkdownCode.args={children:"# Hello, World!\n\nThis is a markdown block.\n\n- Item 1\n- Item 2\n- Item 3",className:"language-markdown"};const CSVCode=args=>(0,jsx_runtime.jsx)(Message,{...args});CSVCode.args={children:"FirstName, LastName, Age\nJohn, Doe, 30\nJane, Doe, 28\nAlice, Smith, 35",className:"language-csv"};const PythonCode=args=>(0,jsx_runtime.jsx)(Message,{...args});PythonCode.args={children:'def hello_world():\n    print("Hello, World!")\n\nhello_world()',className:"language-python"};const JavascriptCode=args=>(0,jsx_runtime.jsx)(Message,{...args});JavascriptCode.args={children:'console.log("Test");',className:"language-javascript"},InlineCode.parameters={...InlineCode.parameters,docs:{...null===(_InlineCode_parameters=InlineCode.parameters)||void 0===_InlineCode_parameters?void 0:_InlineCode_parameters.docs,source:{originalSource:"(args: MessageProps) => <MessageComponent {...args} />",...null===(_InlineCode_parameters1=InlineCode.parameters)||void 0===_InlineCode_parameters1||null===(_InlineCode_parameters_docs=_InlineCode_parameters1.docs)||void 0===_InlineCode_parameters_docs?void 0:_InlineCode_parameters_docs.source}}},GenericCode.parameters={...GenericCode.parameters,docs:{...null===(_GenericCode_parameters=GenericCode.parameters)||void 0===_GenericCode_parameters?void 0:_GenericCode_parameters.docs,source:{originalSource:"(args: MessageProps) => <MessageComponent {...args} />",...null===(_GenericCode_parameters1=GenericCode.parameters)||void 0===_GenericCode_parameters1||null===(_GenericCode_parameters_docs=_GenericCode_parameters1.docs)||void 0===_GenericCode_parameters_docs?void 0:_GenericCode_parameters_docs.source}}},MarkdownCode.parameters={...MarkdownCode.parameters,docs:{...null===(_MarkdownCode_parameters=MarkdownCode.parameters)||void 0===_MarkdownCode_parameters?void 0:_MarkdownCode_parameters.docs,source:{originalSource:"(args: MessageProps) => <MessageComponent {...args} />",...null===(_MarkdownCode_parameters1=MarkdownCode.parameters)||void 0===_MarkdownCode_parameters1||null===(_MarkdownCode_parameters_docs=_MarkdownCode_parameters1.docs)||void 0===_MarkdownCode_parameters_docs?void 0:_MarkdownCode_parameters_docs.source}}},CSVCode.parameters={...CSVCode.parameters,docs:{...null===(_CSVCode_parameters=CSVCode.parameters)||void 0===_CSVCode_parameters?void 0:_CSVCode_parameters.docs,source:{originalSource:"(args: MessageProps) => <MessageComponent {...args} />",...null===(_CSVCode_parameters1=CSVCode.parameters)||void 0===_CSVCode_parameters1||null===(_CSVCode_parameters_docs=_CSVCode_parameters1.docs)||void 0===_CSVCode_parameters_docs?void 0:_CSVCode_parameters_docs.source}}},PythonCode.parameters={...PythonCode.parameters,docs:{...null===(_PythonCode_parameters=PythonCode.parameters)||void 0===_PythonCode_parameters?void 0:_PythonCode_parameters.docs,source:{originalSource:"(args: MessageProps) => <MessageComponent {...args} />",...null===(_PythonCode_parameters1=PythonCode.parameters)||void 0===_PythonCode_parameters1||null===(_PythonCode_parameters_docs=_PythonCode_parameters1.docs)||void 0===_PythonCode_parameters_docs?void 0:_PythonCode_parameters_docs.source}}},JavascriptCode.parameters={...JavascriptCode.parameters,docs:{...null===(_JavascriptCode_parameters=JavascriptCode.parameters)||void 0===_JavascriptCode_parameters?void 0:_JavascriptCode_parameters.docs,source:{originalSource:"(args: MessageProps) => <MessageComponent {...args} />",...null===(_JavascriptCode_parameters1=JavascriptCode.parameters)||void 0===_JavascriptCode_parameters1||null===(_JavascriptCode_parameters_docs=_JavascriptCode_parameters1.docs)||void 0===_JavascriptCode_parameters_docs?void 0:_JavascriptCode_parameters_docs.source}}};const __namedExportsOrder=["InlineCode","GenericCode","MarkdownCode","CSVCode","PythonCode","JavascriptCode"]},"./components/Chat/Message/formatDate.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>formatDate});var process=__webpack_require__("./node_modules/process/browser.js");function formatDate(timestamp){let short=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const date=new Date(timestamp),serverDate=new Date(date.toLocaleString("en-US",{timeZone:process.env.NEXT_PUBLIC_TZ?process.env.NEXT_PUBLIC_TZ.replace("TZ-",""):""})),timeDifference=date.getTime()-serverDate.getTime(),options={year:"numeric",month:short?"short":"long",day:"2-digit",hour:short?"numeric":"2-digit",minute:"2-digit",second:short?void 0:"2-digit",hour12:!0};return new Date(date.getTime()+timeDifference).toLocaleString("en-US",options)}}}]);